---
title: "Lab1"
format: html
editor: visual
---

# Lab 1 - Deterministic Models and Probability

```{r}
library(boot) # for inv.logit()
```

## II. Deterministic Models

### Plotting Deterministic Models

```{r}
par(mfrow = c(2,2))

# linear plot
linear = function(B0, B1, x){  #pay close attention to the syntax of the function command.  The stuff in parantheses are the inputs ot the function
  y = B0 + B1*x     #This is what the function does
  return(y)        #These are the values that the function returns
}
x = -100:100; B0 = 2; B1 = 0.5
y = linear(B0, B1, x)
plot(x,y,type = 'l', main = "linear")

# inv logit plot
inverse = function(B0, B1, x){
  y = inv.logit(B0 + B1*x)
  return(y)        #These are the values that the function returns
}
x = -100:100; B0 = 2; B1 = 0.5
y = inverse(B0, B1, x)
plot(x,y,type = 'l', main = "Inverse Logit")

# exponential plot
exponential = function(B0, B1, x){
  y = exp(B0 + B1*x)
  return(y)        #These are the values that the function returns
}
x = -100:200; B0 = 2; B1 = 0.5
y = exponential(B0, B1, x)
plot(x,y,type = 'l', main = "Exponential")

# aymptotic plot
asymptotic = function(B0, B1, x){
  y = (B0 * x)/(B0/2 + x)
  return(y)        #These are the values that the function returns
}
x = -100:100; B0 = 2; B1 = 0.5
y = asymptotic(B0, B1, x)
plot(x,y,type = 'l', main = "Asymptotic")
```

### Examples for Each Model

sociological or ecological

#### Linear

-   eco - tree growth and precipitation

-   socio - lifespan and wealth

#### Inverse Logit

-   eco - Abundance of a competitive invasive species after the introduction to a new area

-   eco - human growth rate, beacuse speeds way up at adolescence then slows down again

#### Exponential

-   eco - amount of carbon in the atmosphere and the greenhouse effect

-   socio - compounding interest

#### Asymptotic

-   a black hole and the light entering

-   eco - recovery of a formerly increasing species after a major stochastic event that nearly wiped them out

## III. The chain rule of probability

1\. Use the chain rule of probability to factor the joint distribution Pr(ğœƒ1,ğœƒ2,ğœƒ3,ğœƒ4)

into a joint conditional distribution.

Pr(ğœƒ1,ğœƒ2,ğœƒ3,ğœƒ4) = Pr(ğœƒ4\|ğœƒ3,ğœƒ2,ğœƒ1) \* Pr(ğœƒ3\|ğœƒ2,ğœƒ1) \* Pr(ğœƒ2\|ğœƒ1) \* Pr(ğœƒ1)

2\. Consider the following factored joint distribution:

Pr(ğœƒ,ğ‘¤,ğœ‚,ğ›¼)=Pr(ğ›¼âˆ£ğ‘¤,ğœ‚,ğœƒ)Pr(ğ‘¤âˆ£ğœ‚,ğœƒ)Pr(ğœ‚âˆ£ğœƒ)Pr(ğœƒ)

Simplify this equation using the knowledge that ğœ‚ and ğœƒ are independent and that ğ‘¤ and ğœƒ are independent.

Pr(ğœƒ,ğ‘¤,ğœ‚,ğ›¼) = Pr(ğ›¼âˆ£ğ‘¤,ğœ‚,ğœƒ) \* Pr(ğ‘¤âˆ£ğœ‚) \* Pr(ğœ‚) \* Pr(ğœƒ) ????

## IV. Converting DAGs to joint distributions

1.  Pr(a,b,c,d,e) = Pr(a\|c,b) \* Pr(c) \* Pr(b\|d,e) \* Pr(d) \* Pr(e)
2.  Pr(y,z,Î²1,Î²2,ğœƒd,ğœƒp) = Pr(y\|ğœƒd,z) \* Pr(ğœƒd\|Î²1,Î²2) \* Pr(z\|ğœƒp) \* Pr(Î²1) \* Pr(Î²2) \* Pr(ğœƒp)
3.  Pr(Âµ,Ïƒ,Î¦1,Î¦2,x,y,z) = Pr(y\|x,z) \* Pr(x\|Âµ,Ïƒ) \* Pr(z\|Î¦1,Î¦2) \* Pr(Âµ) \* Pr(Ïƒ) \* Pr(Î¦1,Î¦2)
4.  Pr(y1,y2,ğ›„1,ğ›„2,ğ›„3,ğœƒ1,ğœƒ2) = Pr(y1\|ğœƒ1,z) \* Pr(y2\|z,ğœƒ2) \* Pr(ğœƒ1) \* Pr(ğœƒ2) \* Pr(z\|ğ›„1,ğ›„2,ğ›„3) \* Pr(ğ›„1) \* Pr(ğ›„2) \* Pr(ğ›„3)
5.  Pr(A,B,D,E,F,H) = Pr(A\|D,E) \* Pr(B\|H,F) \* Pr(D\|H) \* Pr(H) \* Pr(E) \* Pr(F)

## V. Converting joint distributions to DAGs

Draw Bayesian networks (DAGs) for the joint and conditional
distributions below.

I.Pr(ğ´,ğµ)=Pr(ğ´âˆ£ğµ)Pr(ğµ)

II.Pr(ğ´,ğµ,ğ¶)=Pr(ğ´âˆ£ğµ,ğ¶)Pr(ğµâˆ£ğ¶)Pr(ğ¶)

III.Pr(ğ´,ğµ,ğ¶,ğ·)=Pr(ğ´âˆ£ğ¶)Pr(ğµâˆ£ğ¶)Pr(ğ¶âˆ£ğ·)Pr(ğ·)

IV.Pr(ğ´,ğµ,ğ¶,ğ·,ğ¸)=Pr(ğ´âˆ£ğ¶)Pr(ğµâˆ£ğ¶)Pr(ğ¶âˆ£ğ·,ğ¸)Pr(ğ·)Pr(ğ¸)

V.Pr(ğ´,ğµ,ğ¶,ğ·)=Pr(ğ´âˆ£ğµ,ğ¶,ğ·)Pr(ğµâˆ£ğ¶,ğ·)Pr(ğ¶âˆ£ğ·)Pr(ğ·)

VI.Pr(ğ´,ğµ,ğ¶,ğ·)=Pr(ğ´âˆ£ğµ,ğ¶,ğ·)Pr(ğ¶âˆ£ğ·)Pr(ğµ)Pr(ğ·)

![](images/IMG_4895.jpg)

## VI. Simplifying

Simplify the expression below, given that ğ‘§2

and ğ‘§3 are independent random variables.

Pr(ğ‘§1,ğ‘§2,ğ‘§3)=Pr(ğ‘§1âˆ£ğ‘§2,ğ‘§3)Pr(ğ‘§2âˆ£ğ‘§3)Pr(ğ‘§3)

Simplified:

Pr(ğ‘§1,ğ‘§2,ğ‘§3)=Pr(ğ‘§1\|ğ‘§2,ğ‘§3) \* Pr(ğ‘§2) \* Pr(ğ‘§3)

## VII. Interpreting and factoring

The probability of an observation ğ‘¦ depends on a true ecological state of interest, ğ‘§, and the parameters in a data model, ğœ½ğ‘‘. The probability of the true state ğ‘§ depends on the parameters in an ecological process model, ğœ½ğ‘. We know that ğœ½ğ‘‘ and ğœ½ğ‘ are independent.

Write out a factored expression for the joint distribution, Pr(ğ‘¦,ğ‘§,ğœ½ğ‘‘,ğœ½ğ‘). Drawing a Bayesian network will help.

Pr(ğ‘¦,ğ‘§,ğœ½ğ‘‘,ğœ½ğ‘) = Pr(ğ‘¦\|ğ‘§,ğœ½ğ‘‘) \* Pr(ğ‘§\|ğœ½ğ‘) \* Pr(ğœ½ğ‘‘) \* Pr(ğœ½ğ‘)
